# 2025_2_iict-teamF-final
정보문화기술입문 F조 기말 프로젝트

## 개요
- 프로젝트명: 빛과 그림자의 정원
- 장르: 인터랙티브 미디어 아트 게임
- 기획 배경
    - 모티브: 인적이 끊겨 자연에 잠식당한 폐허의 이미지
    - 의도: 디지털 공간에서도 시간이 흐르고(이끼), 사용자의 행동(빛)에 따라 반응하는 살아있는 정원의 구현

<br>

## 플레이 방법
4단계의 시간 순환(새벽-낮-황혼-밤) 속에서 정원을 가꾸는 과정을 경험한다.

* 생명의 개화: 원하는 위치에 씨앗을 심고, 식물 위로 빛을 비추어 줄기에서 꽃으로 만개시킨다.
* 어둠의 정화: 시간이 흐를수록 증식하는 이끼 위를 빛으로 비추어 이끼를 정화한다.
* 기억의 아카이빙: 정원의 가장 아름다운 순간 혹은 잠식된 최후의 모습을 캡처하여 소장할 수 있다.

### 서버 설정 (필수)
플레이 기록(스크린샷) 저장을 위해 사용자의 Supabase 연결 필요
원활한 플레이를 위해 아래 순서대로 **Supabase Storage** 설정 요망

#### 1. 프로젝트 생성 및 키 발급
1. [Supabase](https://supabase.com/) 회원가입 후 `New Project` 생성
2. 생성 완료 화면에서 **스크롤을 조금 내려** `Project URL`과 `API Key (anon/public)` 복사 (게임 시작 시 필요)
* 생성 완료 화면에서 복사하지 못한 경우:
    * `Project Settings` > `Data API` 메뉴에서 **Project URL** 복사
    * `Project Settings` > `API keys` > `Legacy anon, service_role API keys` 탭에서 **API Key(anon/public)** 복사

#### 2. 스토리지(Bucket) 생성 **(중요!)**
게임 코드와의 연동을 위해 반드시 아래 설정값 준수.

1. 왼쪽 메뉴의 **Storage(보관함)** 아이콘 클릭 > **New Bucket** 클릭
2. **Name of bucket:** `image` (대소문자 정확히 입력)
3. **Public bucket:** `ON` (활성화)
   * *OFF 상태일 경우 QR코드로 이미지 조회 불가*
4. `Save` 클릭

#### 3. 권한(Policy) 설정 **(가장 중요!)**
이미지 업로드 권한 허용을 위한 필수 설정

1. 왼쪽 메뉴의 **Storage** 아이콘 클릭 > 화면 중앙 상단의 **Policies** 탭 클릭
2. `Buckets` 목록에 있는 `image` 항목 확인 후 우측 **New policy** 버튼 클릭
3. `Get started quickly` 선택
4. 템플릿 목록 중 `Allow access to JPG images in a public folder to anonymous users` 선택 > `Use this template` 클릭
5. **Allowed operations** 항목 확인 및 수정:
  * `INSERT` 체크 (업로드 필수)
  * `SELECT` 체크 (조회 필수)
6. `Review` > `Save Policy` 클릭

**설정 완료.** 게임 실행 후 URL과 Key를 입력하여 접속

### 조작 방법
**마우스**
* 이동: 광원 이동
* 우클릭: 씨앗 심기 (새로운 식물 생성)

**키보드**
* <kbd>Spacebar</kbd>: 현재 화면 저장 및 QR 코드 생성
* <kbd>R</kbd>/<kbd>r</kbd> or <kbd>ㄱ</kbd>: 리셋 (게임 초기화)
* <kbd>ESC</kbd>: 강제 종료 (스토리라인으로 전환)

<br>
<br>

## 시스템 구조
본 프로젝트는 상태 관리 시스템을 통해 전체 흐름을 제어하고, 객체 제어 모듈을 통해 개별 요소의 생명주기를 효율적으로 관리하는 구조로 설계되어 있다.

### 1. Main Controller
* 상태 관리 시스템
    - Flow: 시작/튜토리얼 → 플레이 → 스토리라인 → 시작의 순환 구조
    - Transition Logic:
        - 트리거: 이끼의 화면 점유율 90% 달성 시 Delay Timer 가동, 2초 후 스토리라인으로 자동 전환
        - 연출: 전환 직전의 플레이 화면을 캡처하여 엔딩 배경으로 승계
* 환경 시스템
    - Frame Count 기반으로 하루 사이클 구현
    - lerpColor()를 활용하여 4단계(새벽, 낮, 황혼, 밤)의 배경색 및 틴트 실시간 보간

### 2. Object Manager
* 생명주기 관리
    - 생성: 게임 조건(씨앗 심기, 자연 발생)에 따른 객체 추가
    - 제거: 화면 밖으로 나가거나 수명이 다한 객체는 배열에서 즉시 삭제 (메모리 최적화)
* 상호작용 제어
    - 광원-이끼/식물, 이끼-식물 간의 거리(dist)를 실시간으로 계산하여 충돌 감지
    - 식물 보호 로직: 완전히 자란 이끼가 식물에 닿을 경우 3초 타이머가 작동하며, 3초 초과 시 식물 파괴

### 3. Objects
각 객체는 독립적인 클래스 파일로 모듈화되어 있다.

* Light.js: 마우스 좌표를 실시간으로 추적하며, 객체에 닿으면 식물은 성장시키고 이끼는 정화하는 인터랙션 담당
* Moss.js: 게임 주기 및 밤낮 변화에 따라 생성 속도가 조절되며, 식물을 잠식하는 자율 행동 객체
* Plant.js: 줄기-잎-꽃의 단계별 성장 시스템을 가지며, 이끼와 충돌 시 파괴됨

### 4. Server & Archiving
* Supabase Storage: 캡처된 Canvas 데이터를 Blob 형태로 변환하여 비동기 업로드
* QR Code Generation: 업로드 성공 시 반환된 URL을 qrcode.js와 연동하여 실시간 렌더링

<br>
<br>

## 기술적 구현 사항

### 공간 점유율 계산
* Grid Algorithm: 화면을 격자 단위로 샘플링하여 이끼가 화면을 덮은 비율을 실시간으로 계산
* Overgrow Trigger: 이끼 점유율이 90%를 초과할 경우 게임 오버(스토리라인) 트리거 발동

### 시각 효과 구현
* Additive Blending: 어두운 배경 위에 텍스처 RGB 값을 더하는 가산 혼합 방식을 적용하여 발광 효과 연출
* Particle System: 광원 중심부에서 정규 분포(randomGaussian)를 가진 입자를 지속 생성하여 일렁이는 빛 표현

### 절차적 생성
* Recursive Growth: 이끼는 부모 노드 좌표를 기준으로 자식 노드가 파생되는 재귀 알고리즘을 통해 매번 다른 형태의 군집 형성
* Randomized Assets: 식물 생성 시 preload된 다양한 파츠(줄기, 잎, 꽃)를 무작위로 조합하여 개체 생성

<br>
<br>

## 디자인 컨셉
* Assets Design: 부드럽고 귀여운 분위기 조성을 위해 꽃, 빛 구체, 잎사귀 등 모든 에셋을 색연필 질감의 손그림으로 자체 제작
* UI System:
    - 각 게임 단계(시작, 튜토리얼, 플레이, 엔딩 등)에 맞춰 배경과 인터랙션 요소 디자인
    - 텍스트 애니메이션(Typewriter Effect) 및 마우스 오버 효과 적용으로 사용자 몰입감 유도

<br>
<br>

## 디벨롭 및 개선 과정

### 튜토리얼 및 UX 개선
* 튜토리얼 구체화: 긴 텍스트 정보를 2개의 슬라이드로 분할하고 시각 자료를 삽입하여 직관적 이해 유도
* 게임 중 언제든 튜토리얼을 다시 확인할 수 있는 버튼 생성

### 스토리라인 강화
* 게임의 목적성 확립을 위해 중단/엔딩 상황에 따른 차별화된 메시지 출력
    - ESC 중단 시: "빛과 그림자의 정원에 잠시나마 들러 주어서 감사합니다"
    - 엔딩 도달 시: "당신의 여정에 함께할 수 있어 영광이었습니다"

### 밸런싱 및 최적화
* 불합리한 난이도 개선:
    - 식물의 의문사를 방지하기 위해 이끼 충돌 후 3초의 유예 시간 부여
    - 화면 하단(UI 영역)에서의 이끼 생성 로직 삭제
    - 이끼 정화 난이도 조절을 위해 밤 시간대의 생성 속도 완화
* 성능 최적화: 과성장(Lag) 발생 시 이끼 객체 총량을 제한하고 생성 간격을 조절하여 프레임 드랍 방지

### 버그 수정
* 화면 캡처 오류: 캡처 시 배경이 투명하게 저장되는 문제를 해결하기 위해, 저장 직전 알파값을 255로 초기화하는 로직 추가

<br>
<br>

## 사용 라이브러리 및 도구
- Language: JavaScript (ES6+)
- Library: p5.js
- Storage: Supabase
- Utility: QRCode.js

<br>
<br>

## 팀원 및 역할
- 반유진: 기획, 개발
- 김석희: 개발
- 박명진: 개발, 음향
- 이정원: 디자인